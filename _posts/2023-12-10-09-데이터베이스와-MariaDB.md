# 09. 데이터베이스와 MariaDB

# 1. 실세계 모델링과 데이터베이스

데이터베이스란? 실세계에서 발생하는 정보들을 체계적으로 정리하여 컴퓨터에 저장된 것.

체계적 정리는 표의 형식으로 구조화 하는 것을 말하며, 모델링이라고 한다. 

이러한 모델링 과정을 스키마(schema)라고도 한다.

# 2. DB와 DBMS

DBMS(DataBase Management System) : DB의 구조 생성, 데이터 저장, 삭제, 변경등의 관리를 지원하는 소프트웨어 시스템.

## 2.1 DB 구성요소

개념 스키마 : 일정한 구조와 체계를 갖추고 있다.

저장 스키마 : 구조와 체계를 컴퓨터에 저장한다.

필드명은 DBMS에서 식별자 역할을 하기 때문에 영문자로 표기해야 함.

image1

| 용어 | 설명 |
| --- | --- |
| database | 하나의 업무 단위를 의미. 여러 개의 테이블로 구성됨. |
| table | 여러 종류의 데이터를 저장하기 위한 구조. 여러 개의 테이블들이 모여서 하나의 DB를 구성함. |
| field, column | 데이터를 저장하는 최소 단위. 여러 개의 필드들이 모여서 하나의 테이블을 구성함. |
| row, record, tuple | 각 필드들에 입력된 데이터의 모임으로 행 단위로 표현됨. |

하나의 DBMS 내부는 여러 개의 DB 들로 구성되며 각 DB 내부에는 여러 개의  테이블들이 생성된다.

# 3. MySQL서버 접속

MariaDB : 무료로 사용 가능한 오픈소스 형태의 DBMS 소프트웨어, MySQL과 동일하다고 보아도 됨.

MySQL 서버는 백그라운드 프로세스이며 데몬(daemon)이라고 한다. 이것이 동작하게 되면 MySQL의 클라이언트 프로그램인 mysql.exe를 통해 접속할 수 있다.

## 3.1 MySQL 서버의 실행과 중지

MySQL DBMS를 사용하기 위해서는 우선 MySQL 서버가 동작해야 한다.

## 3.2 MySQL 서버 접속과 종료

MySQL 서버에 접속하기 위해서 윈도우 셸에서 mysql.exe 클라이언트 프로그램을 이용한다.

클라이언트 프로그램이 설치된 위치도 알아둘 필요가 있는데 위치는 C:\xampp\mysql\bin 안의 mysql.exe 파일이다.

### 3.2.1 MySQL 접속 계정

mysql.exe 프로그램으로 MySQL 서버에 접속하려면 다음과 같은 3가지의 기본적인 옵션을 지정해야 한다.

1. 호스트이름
2. 계정
3. 비밀번호

ex) C:\xampp\mysql\bin> mysql -hlocalhost -uroot -p******

-h, -u, -p는 옵션표기이다.

| 옵션 | 설명 |
| --- | --- |
| -h(host) | 접속할 호스트 이름이나 주소 |
| -u(user) | mysql에 등록된 사용자 계정(관리자 계정은 root) |
| -p(password) | 사용자 계정에 대한 비밀번호 (초기에는 설정x) |

(1) -h 옵션

mysql 서버가 설치된 시스템의 주소이다. 서버와 클라이언트 컴퓨터가 동일하다면 localhost(127.0.0.1)로 접속가능하다. 다를 경우 서버 컴퓨터의 IP 주소나 도메인 주소를 지정해야 한다.

(2) -u 옵션

root 라는 관리자 계정이 이미 등록되어있다. 추후 새로운 계정 등록가능.

(3) -p 옵션

root 계정의 비밀번호는 초기엔 설정되어 있지 않다.

### 3.2.2 MySQL 서버 접속

MySQL 서버가 동작중이면 mysql.exe 프로그램을 이용하여 접속할 수 있다.

[접속 방법]

1. 명령 프롬프트 프로그램 이용(windows shell)

윈도우 + R 입력 → cmd

C:\Windows\System32>mysql -uroot 입력 (실행이 안될경우 mysql.exe가 있는 폴더로 이동하여 명령어 실행)

MariaDB [(none)] 이 출력 된다면 정상 접속

1. Control Panel Shell 이용
    
    한글 데이터가 깨질 수 있음.
    
    컨트롤패널에서 쉘 클릭후 #뒤에 mysql -uroot 입력
    

### 3.2.3 MySQL 서버 접속 종료

MariaDB [(none)] exit 입력

# 4. MySQL 사용 도구

## 4.1 MySQL 명령어

MySQL 서버 접속 후 서버를 사용하는데 필요한 명령어. MySQL 콘솔에서 사용한다.

## 4.2 MySQL 연산자와 함수

MySQL 프로그래밍 언어의 일종. 따라서 연산자와 함수들이 존재. MySQL 콘솔에서 사용한다.

## 4.3 SQL 문

데이터베이스를 생성하고 데이터를 처리하기 위한 구문을 SQL(Structured Query Language)라고 한다. SQL에는 DDL(데이터 정의어), DML(테이터 처리어), DCL(데이터 제어어) 등이 있다.

## 4.4 MySQL 클라이언트 프로그램

윈도우 셸에서 실행되는 개별 프로그램으로, mysql.exe도 이중에 하나이다. MySQL 서버가 아니라 독립적으로 실행한다.

# 5. MySQL 셸 명령어

MySQL 서버에 접속하게 되면 명령어를 이용하여 다양한 작업을 할 수 있다.

## 5.1 MySQL 명령어 입력 콘솔

MySQL 명령어는 MySQL 서버에 접속 후 콘솔창에서 입력하여 실행된다.

## 5.2 MySQL 명령어 목록

MySQL 명령어 목록. 명령어형과 축약형이 있다. 축약형에서는 대소문자 구분.

| 명령어 | 축약 | 설명 |
| --- | --- | --- |
| ? | \? | 도움말 출력. help명령어와 동일. |
| clear | \c | 현재 입력 문장 지움 |
| connect | \r | 서버에 재접속 |
| delimeter | \d | 문장의 델리미터 설정 |
| edit | \e | 명령어 편집기 실행 |
| ego | \G | mysql 서버에 명령어 전송하여 수직 표현 방식으로 출력 |
| exit | \q | mysql 종료. quit 명령어와 동일. |
| go | \g | mysql 서버에 명령어 전송 |
| help | \h | 도움말 출력. |
| nopager | \n | 페이지 단위 출력기능 해제 |
| notee | \t | 출력파일 설정 해제 |
| pager | \P | 페이지 단위 출력기능 설정 |
| print | \p | 현재 입력 문장 결과 출력 |
| prompt | \R | 지정한 문장으로 프롬프트 설정 |
| quit | \q | mysql 종료. |
| rehash | \# | 해쉬 재설정 |
| source | \. | SQL 스크립트 파일 실행 |
| status | \s | mysql 서버의 상태정보 출력 |
| system | \! | 셸 명령어 실행 |
| tee | \T | 문장 처리 내용 저장을 위한 출력파일 설정 |
| use | \u | 데이터베이스 사용 |
| charset | \C | 문자 세트 설정 |
| warnings | \W | 문장 처리후 경고 메시지 출력 |
| nowarnings | \w | 문장 처리후 경고 메시지 출력 해제 |

# 6. MySQL 연산자

MySQL 에는 많은 연산자가 있으며 SELECT 구문을 이용하여 결과를 확인할 수 있다.

## 6.1 사용자 정의 변수와 할당연산자

### 6.1.1 변수 선언과 값 할당

사용자가 정의하는 변수명은 @기호로  시작하여 만들 수 있다. 

SET 명령어를 통해 정의 한다.

:= or = 기호를 통해 값을 할당한다.

### 6.1.2 :=연산자와 =연산자의 차이

| 연산자 | 설명 |
| --- | --- |
| := | 값 할당 |
| = | 값 할당 UPDATE ~ SET 문에서의 값 할당 또는 비교연산자 역할 |

= 연산자의 왼쪽에는 사용자정의 변수 뿐 아니라 필드명도 포함됨.

### 6.1.3 사용자 정의 변수 삭제

사용자 정의 변수들은 MySQL 시스템 데이터 베이스인 information_schema 내부의 USER_VARIABLES 라는 환경변수에 저장되어 있다.

등록된 변수를 확인하려면 select * from information_schema.USER_VARIABLES; 와 같이 입력하면 된다.

등록된 변수를 삭제하려면 MySQL을 종료하면 되지만 FLUSH명령어를 입력해도 된다.

FLUSH명령어 : FLUSH USER_VARIABLES;

## 6.2 연산자

### 6.2.1 산술연산자

두 수를 계산하는 연산자

| 연산자 | 설명 |
| --- | --- |
| %, MOD | 나머지 연산 |
| * | 곱하기 |
| + | 더하기 |
| - | 빼기, 음수 기호 |
| / | 나누기 |

```sql
SELECT 11 * 22 AS '11 X 22';
+---------+
| 11 X 22 |
+---------+
|     242 |
+---------+
```

### 6.2.2 비교연산자

연산자의 좌우에 있는 피연산자의 값을 비교하여 참이면 1 거짓이면 0을 리턴함.

| 연산자 | 설명 |
| --- | --- |
| a > b | a 가 b 보다 크면 1 |
| a ≥ b | a 가 b 보다 크거나 같으면 1 |
| a < b | a 가 b 보다 작으면 1 |
| a <> b | a 와 b가 다르면 1 (≠과 동일) |
| a ≤ b | a 가 b 보다 작거나 같으면 1 |
| a = b | a 와 b가 같으면 1 (NULL 값은 비교 대상 x) |
| a <=>b | a 와 b가 같으면 1 (NULL 값도 비교 대상) |

NULL 값이 비교대상이라는 말은 NULL도 숫자로 취급하여 NULL과 숫자를 비교할 수 있다는 뜻.

ex) NULL = 5 → NULL

NULL <=> 5 → 0

### 6.2.3 논리연산자

논리연산자는 TRUE(1), FALSE(0), NULL 값을 반환한다.

| 연산자 | 설명 | 예시 |
| --- | --- | --- |
| AND, && | 논리곱 | SELECT 1 AND NULL; → NULL |
|  NOT, ! | Negates value | SELECT NOT 10; → 0 |
| OR, || | 논리합 | SELECT 0 OR NULL; → NULL |
| XOR | 논리 XOR (논리값이 다를때 1) | SELECT 1 XOR NULL; → NULL |

# 7. MySQL 함수

MySQL은 다양한 함수를 제공하고 있으며 SLELECT 구문을 이용하여 결과를 확인할 수 있다.

## 7.1 문자열 함수

문자열 처리와 관련된 함수 60여개 중 많이 사용되는 함수

| 연산자 | 설명 |
| --- | --- |
| ASCII(문자열) | 문자열 첫 번째 문자의 ASCII 코드 반환 |
| CHAR(정수, …) | 정수(ASCII)에 해당되는 문자 반환 |
| CHAR_LENGTH(문자열) | 문자열의 글자 개수 반환 |
| CONCAT(문자열1, 문자열2, …) | 문자열들을 합친 문자열 반환 |
| ROTMAT(숫자, 자리수) | 10진수 소수점 표시로 반환 |
| LENGTH(문자열) | 문자열의 바이트 수 반환 |

## 7.2 수학함수

수학과 관련된 함수 30여개중 많이 사용되는 함수

| 연산자 | 설명 |
| --- | --- |
| CEIL(숫자) | 숫자보다 작지 않은 가장 작은 정수 반환 (올림) |
| FLOOR(숫자) | 숫자보다 크지 않은 가장 큰 정수 반환 (내림) |
| POW(n1, n2) | n1의 n2승 |
| ROUND(실수, 자리수) | 자리수 지정 반올림 |

## 7.3 집계함수

| 연산자 | 설명 |
| --- | --- |
| AVG(필드명) | 필드명에 해당되는 평균값 반환 |
| COUNT(필드명) | 필드명에 해당되는 개수 반환 |
| MAX(필드명) | 필드명에 해당되는 최대값 반환 |
| MIN(필드명) | 필드명에 해당되는 최소값 반환 |
| STD(필드명) | 필드명에 해당되는 표준편차값 반환 |
| SUM(필드명) | 필드명에 해당되는 합계 반환 |

## 7.4 날짜/시간함수

| 연산자 | 설명 |
| --- | --- |
| UTC_DATE() | 현재 날짜를 반환 |
| UTC_TIME() | 현재 시간을 반환 |

# 8. SQL 문

sql문은 데이터베이스를 다루기 위한 구문으로 테이블 생성, 데이터 생성, 변경, 삭제, 검색등의 작업을 위해 사용한다. 이를 DB Query 언어 라고도 한다.

SQL문은 기능에 따라 3가지로 구분되는데, 여기서는 전체적인 개념만 설명한다.

## 8.1 데이터 정의어 (DDL : Data Definition Language)

구조적으로 모델링된 스키마를 데이터베이스 형태로 저장하는데 사용되는 도구.

데이터가 저장되기 위한 구조 즉, 테이블의 생성, 수정, 삭제등에 사용되는 명령어

| SQL문 | 설명 |
| --- | --- |
| create database | 새로운 데이터베이스 생성 |
| create table | 새로운 테이블 생성 |
| alter table | 기존 테이블 구성 변경 |
| drop database/table | 기존 데이터베이스 / 테이블 삭제 |

## 8.2 데이터 처리어(DML : Data Manipulation Language)

생성된 테이블의 데이터를 저장, 변경, 검색, 삭제하는데 사용되는 도구.

| SQL문 | 설명 |
| --- | --- |
| select * from tbl_name | 테이블의 데이터 검색 |
| insert into tbl_name | 테이블에 데이터 삽입 |
| update set tbl_name | 테이블의 데이터 변경 |
| delete from tbl_name | 테이블의 데이터 삭제 |

## 8.3 데이터 제어어(DCL : Data Control Language)

데이터의 권한제어, 복구등을 수행하는데 사용되는 도구

| SQL 문 | 설명 |
| --- | --- |
| grant update on | 특정 사용자에게 수정 권한 부여 |
| revoke update on | 특정 사용자의 권한을 취소 |
| rollback | 직전 질의어 수행을 취소 |
| delete from tbl_name | 테이블의 데이터 삭제 |

# 9. MySQL 클라이언트 프로그램

(1)mysql : MySQL서버에 접속하기 위한 기본프로그램.

(2)mysqladmin : 데이터 베이스의 생성, 삭제등을 수행하는 프로그램.

(3)mysqldump : 데이터베이스를 백업하는 프로그램.

(4)mysqlimport : 데이터 파일을 이용하여 테이블에 데이터를 입력하는 프로그램.

(5)mysqlshow : 데이터베이스, 테이블, 컬럼등의 목록을 확인하는 프로그램.